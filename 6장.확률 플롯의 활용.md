#연속형 자료에 대하여 특정 확률모형을 상정하는 경우에 과연 그 모형이 관측자료와 부합하는지
#평가할 필요가 있다. 이를 위해 qq(quantile-quantile)플롯이라는 방법을 활용해보자.

#6.1 정규확률 플롯
#6.2 
#6.3 정규확률 플롯의 여러 패턴

#1) 정규분포로부터의 모의생성 자료에 대한 정규확률 플롯
par(mfrow=c(1,2))
qqnorm(rnorm(40,100,15)) #--정규분포(표본수,평균,표준편차)
qqnorm(rnorm(40,100,15))
#2) 혼합 정규분포로부터의 모의생성 자료에 대한 정규확률 플롯
par(mfrow=c(1,2))
qqnorm(c(rnorm(20,70,15), rnorm(20,130,15)))
qqnorm(c(rnorm(20,70,15), rnorm(20,130,15)))
##=>그래프의 중앙에서 밀도가 낮고 우상과 좌하 부분에서 강한 곡선성을 볼 수 있다.
#3) 특이값이 내재하는 모의생성 자료에 대한 정규확률 분포
c(25,175,rnorm(38,100,15))
qqnorm(c(25,175,rnorm(38,100,15)))
qqnorm(c(25,175,rnorm(38,100,15)))
#4) 꼬리가 짧은 분포(균일분포)로부터의 모의생성 자료에 대한 정규확률 플롯
qqnorm(runif(40,80,120)) #--구간 80에서 120 사이에서 같은 밀도를 갖는 균일분포, 크기 40
qqnorm(runif(40,80,120))
#5) 꼬리가 긴 분포(이중지수분포)로부터의 모의생성 자료에 대한 정규확률 플롯
qqnorm(c(rexp(20,1), -rexp(20,1)))
qqnorm(c(rexp(20,1), -rexp(20,1)))
#==>비스듬한 역 s자 모양
#6) 큰 값 쪽으로 긴 꼬리를 뻗은 기울어진 분포(로그정규분포)의 경우
qqnorm(exp(rnorm(40,5,1)))
qqnorm(exp(rnorm(40,5,1)))
#==>비스듬히 기울어진 j자 곡선
#7)작은 값 쪽으로 긴 꼬리를 뻗은 기울어진 분포의 경우
qqnorm(1500-exp(rnorm(40,5,1)))
qqnorm(1500-exp(rnorm(40,5,1)))

#6.4
#6.5 두 표본의 등화
x<-rbeta(800,2,3)*100
y<-rbeta(1200,3,2)*100
round(quantile(x),1)
round(quantile(y),1)
#-->x형 시험점수의 중간값은 37.3, Y형 시험점수의 중간값은 61.7
#-->형평성을 위해 37.3을 61.7로, X의 점수들도 Y의 분위수로 바꿔주어야 한다.
par(mfrow=c(1,2))
qqplot(x,y,xlim=c(0,100))
qqplot(x,y,xlim=c(0,100), type="1") #-->에러

##==>결론: qqplot은 관측자료가 특정 확률모형과 부합하면 선형적 패턴을 보인다.
##==> 비선형적 패턴을 보이는 경우 그것이 의미하는 바를 생각해봐야 한다.
